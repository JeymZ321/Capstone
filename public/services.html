<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, shrink-to-fit=no">
    <title>Services - Reynaldo's Car Care Center</title>
    <link rel="icon" type="image/png" sizes="32x32" href="assets/img/reynaldoslogo.png">
    <link rel="stylesheet" href="assets/bootstrap/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat:400,400i,700,700i,600,600i">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Bebas+Neue&amp;display=swap">
    <link rel="stylesheet" href="assets/fonts/simple-line-icons.min.css">
    <link rel="stylesheet" href="assets/css/about_us_extra.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/3.5.2/animate.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/aos/2.3.4/aos.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/baguettebox.js/1.10.0/baguetteBox.min.css">
    <link rel="stylesheet" href="assets/css/vanilla-zoom.min.css">
    <link rel="stylesheet" href="assets/css/services.css">
    <link rel="stylesheet" href="assets/css/hover_button.css">
    <link rel="stylesheet" href="assets/css/imagesliderpanels.css">

    <style>
        .modal-body {
            max-height: 85vh;
            overflow-y: auto;
        }

        .modal-header{
            background-color: darkred;
            color: white;
        }

        .modal-header .btn-close{
            background-color: rgb(255, 255, 255);
        }

        .items{
            padding-top: 0px !important;
        }

        .desc{
            font-size: 13px;
        }
       
        @media (max-width: 320px) {
            .items{
                padding: 2px !important;
            }

          
        }

        

    </style>
    
</head>


<body>
    <nav class="navbar navbar-dark navbar-expand-lg fixed-top clean-navbar" style="background: #051129;">
        <div class="container">
            
            <a class="navbar-brand logo" href="index.html"><img class="img-fluid" src="assets/img/reynaldoslogo.png" width="100px" style="margin: 0px;padding: 0px;" href="index.html"></a>
            <button data-bs-toggle="collapse" class="navbar-toggler" data-bs-target="#navcol-1"><span class="visually-hidden">Toggle navigation</span><span class="navbar-toggler-icon"></span></button>
            <div class="collapse navbar-collapse" id="navcol-1">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item"><a class="nav-link" href="index.html">Home</a></li>
                    <li class="nav-item"><a class="nav-link active" href="services.html">Services</a></li>
                    <li class="nav-item"><a class="nav-link" href="about-us.html">About Us</a></li>
                    <li class="nav-item"><a class="nav-link" href="contact-us.html">Contact Us</a></li>
                    <li class="nav-item"><a class="nav-link" href="gallery.html">Gallery</a></li>
                    <li class="nav-item"><a class="btn btn-primary" role="button" style="height: 35px; background: rgb(169,11,11);border-style: none;" href="login.html">Login</a></li>
                </ul>
            </div>
        </div>
    </nav>
    <main class="page shopping-cart-page">
        <section class="clean-block clean-cart dark">
            <div class="container">
                <div class="block-heading">
                    <h2 style="color: rgb(112,18,18);font-weight: bold;">Services</h2>
                </div>
                <div class="content">
                    <div class="row g-0">
                        <!-- Service Selection Section -->
                        <div class="col-md-12 col-lg-8">
                            <!-- Search Bar -->
                            <div class="search-bar">
                                <input type="text" placeholder="Search service..." class="search-input" id="search-input" />
                            </div>
                            <!-- Category Buttons and Dropdown -->
                            <div class="items" id="cart-items">
                                <div class="category-buttons text-center mb-4">
                                    <button class="category-button" onclick="filterProducts('all')">All</button>
                                    <button class="category-button" onclick="filterProducts('mechanical')">Mechanical</button>
                                    <button class="category-button" onclick="filterProducts('ac-services')">AC Services</button>
                                    <button class="category-button" onclick="filterProducts('paint-restoration')">Paint Restoration</button>
                                    <button class="category-button" onclick="filterProducts('electrical')">Electrical</button>
                                    <button class="category-button" onclick="filterProducts('panels')">Panel Repaints</button>
                                    <button class="category-button" onclick="filterProducts('packages-promos')">Packages and Promos</button>
                                </div>
                                <select id="category-dropdown" class="mobile-dropdown" onchange="filterByCategory(this.value)">
                                    <option value="all">All Categories</option>
                                    <option value="mechanical">Mechanical</option>
                                    <option value="ac-services">AC Services</option>
                                    <option value="paint-restoration">Paint Restoration</option>
                                    <option value="electrical">Electrical</option>
                                    <option value="panels">Panel Repaints</option>
                                    <option value="packages-promos">Packages and Promos</option>
                                </select>
                                <!-- Products -->
                                <div class="row">
                                    <div class="product-grid">
                                        
                                        <!-- Add more products as needed -->
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- Summary Section -->
                        <div class="col-md-12 col-lg-4">
                            <div class="summary">
                                <h3>Summary</h3>
                                <h4><span class="text">Service(s):</span></h4>
                                <h4><span class="price" id="cart-details"></span></h4>
                                <h4><span class="text">Subtotal:</span><span class="price" id="subtotal">₱ 0.00</span></h4>
                                <h4><span class="text">Total:</span><span class="price" id="total">₱ 0.00</span></h4>
                                <button id="clear-all" class="btn btn-primary btn-sm" onclick="clearCart()">Clear All</button>
                                <p class="mt-2 mb-1" style="opacity: .7; font-size: 14px;">
                                    <i><strong>Note:</strong> Proceeding with the Appointment will require you to pay a processing fee of 
                                    <strong style="color: red;">₱ 500.00</strong>. Prices of services may vary upon actual inspection. This fee is consumable for the actual execution of services.</i>
                                </p>
                                <a href="login.html" id="login-link">
                                    <button class="btn btn-primary btn-lg d-block w-100 btn-estimate" 
                                        style="background-color: rgb(255, 255, 255); text-decoration:none; color: rgb(0, 0, 0); border:1px solid black;" 
                                        type="button">Get Appointment
                                    </button>
                                </a>
                                
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </section>
    </main>
    

    <footer class="page-footer dark">
        <div class="container">
            <div class="row">
                <div class="col"><img class="img-fluid" src="assets/img/reynaldoslogo.png" width="200px" style="margin: 0px;padding: 0px;" href="index.html"></div>
                <div class="col-sm-3">
                    <h5>Get started</h5>
                    <ul>
                        <li><a href="index.html">Home</a></li>
                        <li><a href="login.html">Sign up</a></li>
                        <li><a href="services.html">Services</a></li>
                    </ul>
                </div>
                <div class="col-sm-3">
                    <h5>About us</h5>
                    <ul>
                        <li><a href="about-us.html">Company Information</a></li>
                        <li><a href="contact-us.html">Contact us</a></li>
                        <li><a href="#">Reviews</a></li>
                    </ul>
                </div>
                <div class="col-sm-3">
                    <h5>Legal</h5>
                    <ul>
                        <li><a href="#">Terms of Service</a></li>
                        <li><a href="#">Terms of Use</a></li>
                        <li><a href="#">Privacy Policy</a></li>
                    </ul>
                </div>
            </div>
        </div>
        <div class="footer-copyright">
            <p>© 2024 Reynaldo's Car Care Center</p>
        </div>
    </footer>
    <script src="assets/bootstrap/js/bootstrap.min.js"></script>
    <script src="assets/js/bs-init.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/aos/2.3.4/aos.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/baguettebox.js/1.10.0/baguetteBox.min.js"></script>
    <script src="assets/js/vanilla-zoom.js"></script>
    <script src="assets/js/theme.js"></script>
    <script> window.chtlConfig = { chatbotId: "7859665798" } </script>
<script async data-id="7859665798" id="chatling-embed-script" type="text/javascript" src="https://chatling.ai/js/embed.js"></script>
    
    
    <script>
        let allServices = []; // To hold all services fetched from the backend
        let selectedServices = []; // To track services added to the summary
        
       

        //FILTER BY CATEGORY BUTTONS
        function filterProducts(category) {   

            const products = document.querySelectorAll('.product');
            products.forEach(product => {
                product.style.display = 'none'; // Hide all products first
                if (product.classList.contains(category)) {
                    product.style.display = 'block'; // Show only products in the selected category
                }
            });

            if (category === 'all') {
                displayServices(allServices); // Show all services if "all" is selected
            } else {
                const filteredServices = allServices.filter(service => service.category === category);
                displayServices(filteredServices); // Show only filtered services
            }
    
            const categoryButtons = document.querySelectorAll('.category-button');
            categoryButtons.forEach(button => {
                button.style.backgroundColor = '';
            });
            document.querySelector(`[onclick="filterProducts('${category}')"]`).style.backgroundColor = 'rgb(169, 11, 11)';
        }

        //FILTER BY CATEGORY DROPDOWN (MEDIA QUERY)
        function filterByCategory(category) {
            // Hide all products first
            const products = document.querySelectorAll('.product');
            products.forEach(product => {
                product.style.display = 'none'; 
                if (product.classList.contains(category)) {
                    product.style.display = 'block'; // Show only products in the selected category
                }
            });

            // Filter services based on selected category
            if (category === 'all') {
                displayServices(allServices); // Show all services if "all" is selected
            } else {
                const filteredServices = allServices.filter(service => service.category === category);
                displayServices(filteredServices); // Show only filtered services
            }

            // Reset background color for category buttons
            const categoryButtons = document.querySelectorAll('.category-button');
            categoryButtons.forEach(button => {
                button.style.backgroundColor = '';
            });

            // If the category is "all", no button is highlighted
            if (category !== 'all') {
                // Assuming category buttons have corresponding `onclick` handlers to filter by category
                const activeButton = document.querySelector(`[onclick="filterProducts('${category}')"]`);
                if (activeButton) {
                    activeButton.style.backgroundColor = 'rgb(169, 11, 11)'; // Set active color
                }
            }
        }


        


        // Fetch Services from Backend (Admin CMS)
        async function fetchServices() {
            try {
                const response = await fetch('/api/services'); // Replace this with your actual API endpoint
                allServices = await response.json();
                displayServices(allServices);
            } catch (error) {
                console.error('Error fetching services:', error);
                alert('Unable to load services. Please try again later.');
            }
        }

    
        // Display Services on the Page
function displayServices(services) {
    const container = document.querySelector('.product-grid');
    container.innerHTML = '';

    if (services.length === 0) {
        container.innerHTML = '<p>No services available at the moment.</p>';
        return;
    }

    services.forEach(service => {
        const product = document.createElement('div');
        product.className = `product ${service.category} product-container`;

        // Limit for description
        const charLimit = 70;
        const shortDesc = service.description.length > charLimit 
            ? service.description.substring(0, charLimit) + '...' 
            : service.description;

        product.innerHTML = `
            <div class="product-image">
                <img class="img-fluid d-block mx-auto image" style="width: auto; height: auto;" 
                     src="${service.image}" alt="${service.name}" />
            </div>
            <div class="product-info">
                <div class="details-column">
                    <p class="product-name">${service.name}</p>
                    <p class="desc">
                        <span class="short-desc">${shortDesc}</span>
                        <span class="full-desc" style="display: none;">${service.description}</span>
                        ${service.description.length > charLimit 
                            ? '<button class="see-more btn btn-link btn-sm">See more</button>' 
                            : ''}
                    </p>
                    <p class="mechanic"><strong>Mechanic:</strong> ${service.mechanic || 'N/A'}</p>
                    <p class="estimation"><strong>Estimation:</strong> ${service.estimation || 'N/A'}</p>
                    <div class="price" style="text-align: left;">
                        <span class="price-per-item mb-3" style="font-size: 15px; float:left;" data-price="${service.price}">Price: <span style="color: red; font-weight: bold;">₱${service.price.toFixed(2)}<strong>+</strong>⬆️  </span></span>
                    </div>
                    <br>
                    
                    <button class="btn btn-primary add-to-summary btn-sm float-end" 
                        onclick="addToSummary('${service._id}', '${service.name}', ${service.price}, '${service.image}')">
                        Add Service
                    </button>
                </div>
            </div>`;

        container.appendChild(product);

        // Add event listener for "See more" button
        const seeMoreBtn = product.querySelector('.see-more');
        if (seeMoreBtn) {
            seeMoreBtn.addEventListener('click', () => {
                const fullDesc = product.querySelector('.full-desc');
                const shortDesc = product.querySelector('.short-desc');
                if (fullDesc.style.display === 'none') {
                    fullDesc.style.display = 'inline';
                    shortDesc.style.display = 'none';
                    seeMoreBtn.textContent = 'See less';
                    
                } else {
                    fullDesc.style.display = 'none';
                    shortDesc.style.display = 'inline';
                    seeMoreBtn.textContent = 'See more';
                }
            });
        }
    });
}

        // Add Service to Summary
        function addToSummary(_id, name, price, image, mechanic, estimation) {
            if (selectedServices.find(service => service._id === _id)) { // Change some() to find()
                alert(`${name} is already in the summary!`);
                return;
            }
            selectedServices.push({ _id, name, price, image, mechanic, estimation });
            localStorage.setItem('selectedServices', JSON.stringify(selectedServices)); // Save to localStorage
            
            updateSummary();

            const button = document.querySelector(`button[onclick*="${_id}"]`);
            if (button) {
                button.disabled = true;
                button.textContent = "Added";
                button.style.backgroundColor = "red";
                button.style.borderColor = "red";
            }
        }
    
        // Cancel Service from Summary
        function cancelFromSummary(_id) {
            const service = selectedServices.find(service => service._id === _id);
            if (service) {
                
                localStorage.removeItem('selectedServices'); // Clear localStorage
                selectedServices = selectedServices.filter(service => service._id !== _id);
                updateSummary();

                const button = document.querySelector(`button[onclick*="${_id}"]`);
                if (button) {
                    button.disabled = false;
                    button.textContent = "Add Service";
                    button.style.backgroundColor = "#0d6efd";
                    button.style.borderColor = "#0d6efd";
                }
            }
        }
    
        // Clear All Services from Summary
        function clearCart() {
            if (selectedServices.length === 0) {
                alert('No services to clear.');
                return;
            }
    
            if (confirm('Are you sure you want to clear all selected services?')) {
                selectedServices = [];
                alert('All services have been cleared from the SUMMARY.');

                const buttons = document.querySelectorAll('button[onclick*="addToSummary"]');
                buttons.forEach(button => {
                    button.disabled = false;
                    button.textContent = "Add Service";
                    button.style.backgroundColor = "#0d6efd";
                    button.style.borderColor = "#0d6efd";
                });

                updateSummary();
            }
            
        }
    
        // Update the Summary Section
        function updateSummary() {
            const summaryContainer = document.getElementById('cart-details');
            const subtotalElement = document.getElementById('subtotal');
            const totalElement = document.getElementById('total');
            
            // Clear previous summary
            summaryContainer.innerHTML = '';

            if (selectedServices.length === 0) {
                summaryContainer.innerHTML = '<p>No services selected yet.</p>';
                subtotalElement.textContent = '₱ 0.00';
                totalElement.textContent = '₱ 0.00'; 
                return;
            }

            let subtotal = 0;
            document.getElementById('cart-details').style.display = 'block';
            
            // Loop through selected services and add them to the summary
            selectedServices.forEach(service => {
                subtotal += service.price;
                const summaryItem = document.createElement('div');
                summaryItem.className = 'cart-item d-flex align-items-center';
                summaryItem.innerHTML = `
                    <div class="cart-item-box d-flex align-items-center">
                        <img src="${service.image}" alt="${service.name}" style="width: 40px; margin-right: 10px; margin-left: 10px; margin-bottom: 1px;">
                        <span style="flex: 1; margin-right: 10px;">${service.name}</span>
                        <span style="margin-right: 0px; ">₱ ${service.price.toFixed(2)}</span>
                        <button class="btn cancel-button" onclick="cancelFromSummary('${service._id}')"><img src="assets/img/x_button.png" alt="Cancel" class="x-icon"></button>
                    </div>`;
                summaryContainer.appendChild(summaryItem);
                
            });

            subtotalElement.textContent = `₱ ${subtotal.toFixed(2)}`;
            totalElement.textContent = `₱ ${(subtotal).toFixed(2)}`; 
        }

    
        // Search Services
        function searchServices() {
            const searchTerm = document.querySelector('.search-input').value.toLowerCase();
            const filteredServices = allServices.filter(service =>
                service.name.toLowerCase().includes(searchTerm)
            );
            displayServices(filteredServices);
        }

        document.getElementById('login-link').addEventListener('click', function (event) {
            event.preventDefault(); // Prevent the default link action
            alert('You need to login first to continue.'); // Show alert
            window.location.href = 'login.html'; // Redirect to login page
        });

        
    
        // Event Listener for Search
        document.querySelector('.search-input').addEventListener('input', searchServices);
    
        // Initial Fetch of Services on Page Load
        fetchServices();
    </script>
    
    
</body>
</html>
